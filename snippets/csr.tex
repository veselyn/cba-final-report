\begin{minted}[linenos,
    numbersep=5pt,
    gobble=0,
    frame=lines,
    framesep=2mm]{typescript}
//HTML elements removed for brevity
"use client";

const FormID = "learning-preferences-form";
const LearningPreferencesClientFormSchema = LearningPreferencesFormSchema.merge(
  z.object({
    skills: z.array(
      z.object({
        category: z.string().min(1),
        skill: z.string().min(1),
      }),
    ),
  }),
);
export type Skill = Selectable<
  Pick<DBTypes.Skills, "id" | "category" | "skill">
>;
export function LearningPreferencesClient({
  availableSkills,
  defaultValues,
}: {
  availableSkills: Map<string, Skill[]>;
  defaultValues: z.infer<typeof LearningPreferencesClientFormSchema>;
}) {
  const [, updateLearningPreferencesAction] = useFormState(
    updateLearningPreferences,
    {
      status: "idle",
      message: "",
    },
  );
  const form = useForm({
    resolver: zodResolver(LearningPreferencesClientFormSchema),
    defaultValues,
  });
  const handleSubmit = (
    values: z.infer<typeof LearningPreferencesClientFormSchema>,
  ) => {
    updateLearningPreferencesAction({
      skills: values.skills.map((skill) => skill.skill),
    });

    form.reset(values);
  };
  return (
    <>
      <CardContent className="flex justify-center">
        <Form {...form}>
          <form
            id={FormID}
            onSubmit={form.handleSubmit(handleSubmit)}
            className="space-y-2"
          >
            {skillsFieldArray.fields.map((item, index) => (
              <fieldset className={"flex items-end gap-4"} key={item.id}>
                <FormField
                  control={form.control}
                  name={`skills.${index}.category`}
                  render={({ field }) => (
                    <FormItem className="space-y-0 flex-1">
                      <FormLabel className={"text-base"}>Category</FormLabel>
                      <Select
                        value={field.value}
                        disabled={field.disabled}
                        onValueChange={field.onChange}
                      >
                        <FormControl>
                          <SelectTrigger className="max-w-[280px]">
                            <SelectValue placeholder="Category" />
                          </SelectTrigger>
                        </FormControl>
                        <SelectContent>
                          {Array.from(availableSkills.keys()).map((key) => (
                            <SelectItem key={key} value={key}>
                              {key}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </fieldset>
            ))}
          </form>
        </Form>
      </CardContent>
      <CardFooter className="flex-row-reverse">
        <Button
          type="submit"
          form={FormID}
          disabled={!form.formState.isDirty || form.formState.isSubmitting}
        >
          Update
        </Button>
      </CardFooter>
    </>
  );
}
\end{minted}